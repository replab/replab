
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
  
  <!-- Licensed under the Apache 2.0 License -->
  <link rel="stylesheet" type="text/css" href="../../_static/fonts/open-sans/stylesheet.css" />
  <!-- Licensed under the SIL Open Font License -->
  <link rel="stylesheet" type="text/css" href="../../_static/fonts/source-serif-pro/source-serif-pro.css" />
  <link rel="stylesheet" type="text/css" href="../../_static/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="../../_static/css/bootstrap-theme.min.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <title>2. Finding an upper bound on CHSH, symmetrized version &#8212; RepLAB 0.6.6 documentation</title>
    <link rel="stylesheet" href="../../_static/guzzle.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/collapse_admonitions.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../_static/collapse_admonitions.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script type="text/javascript" src="../../_static/js/collapse_helper.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Publications using RepLAB" href="../../publications/index.html" />
    <link rel="prev" title="1. Introduction to representation for quantum information people" href="Tutorial1.html" />
  
  
   

  
  
  <style type="text/css">
    ul.ablog-archive {list-style: none; overflow: auto; margin-left: 0px}
    ul.ablog-archive li {float: left; margin-right: 5px; font-size: 80%}
    ul.postlist a {font-style: italic;}
    ul.postlist-style-disc {list-style-type: disc;}
    ul.postlist-style-none {list-style-type: none;}
    ul.postlist-style-circle {list-style-type: circle;}
  </style>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../mat-modindex.html" title="MATLAB Module Index"
             >matlab index</a> |</li>
        <li class="right" >
          <a href="../../publications/index.html" title="Publications using RepLAB"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="Tutorial1.html" title="1. Introduction to representation for quantum information people"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">RepLAB 0.6.6 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Talks</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">Brussels visit October 2019</a> &#187;</li> 
      </ul>
    </div>
    <div class="container-wrapper">

      <div id="mobile-toggle">
        <a href="#"><span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span></a>
      </div>
  <div id="left-column">
    <div class="sphinxsidebar"><div class="text-logo">
  <a href="
    ../../index.html">RepLAB</a>&nbsp;&nbsp;
  <a href="https://github.com/replab/replab"><i class="fab fa-github"></i></a>&nbsp;
  <a href="https://github.com/replab/replab/archive/v0.6.6.zip"><i class="fa fa-download"></i></a>&nbsp;
  <a href="https://gitter.im/replab/replab"><i class="fab fa-gitter"></i></a>&nbsp;
  <a href="https://travis-ci.com/replab/replab"><i class="fas fa-sync-alt"></i></a>&nbsp;
  <a href="https://codecov.io/gh/replab/replab"><i class="fas fa-umbrella"></i></a>
</div><div class="sidebar-block">
  <div class="sidebar-toc">
    
    
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../howto/index.html">How to</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../topic/index.html">Topic guides</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Talks</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../QCS2019/index.html">Quantum Causal Structures Oxford 2019</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Brussels visit October 2019</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="Tutorial1.html">1. Introduction to representation for quantum information people</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">2. Finding an upper bound on CHSH, symmetrized version</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../publications/index.html">Publications using RepLAB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">Technical Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/index.html">Development/Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/index.html">Blog</a></li>
</ul>

    
  </div>
</div>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <h2><a href="../../blog.html">Recent Blog Posts</a></h2>
  </div>
  <div class="sidebar-toc">
    <ul>
      
      
      <li class="toctree-l1"><a href="../../blog/20200123-RepLAB-website-live.html">26 January - The RepLAB documentation and the infrastructure behind it</a></li>
      
    </ul>
  </div>
</div>

      
    </div>
  </div>
        <div id="right-column">
          
          <div role="navigation" aria-label="breadcrumbs navigation">
            <ol class="breadcrumb">
              <li><a href="../../index.html">Docs</a></li>
              
                <li><a href="../index.html">Talks</a></li>
              
                <li><a href="index.html">Brussels visit October 2019</a></li>
              
              <li>2. Finding an upper bound on CHSH, symmetrized version</li>
            </ol>
          </div>
          
          <div class="document clearer body">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 6ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="2.-Finding-an-upper-bound-on-CHSH,-symmetrized-version">
<h1>2. Finding an upper bound on CHSH, symmetrized version<a class="headerlink" href="#2.-Finding-an-upper-bound-on-CHSH,-symmetrized-version" title="Permalink to this headline">¶</a></h1>
<p>We initialize the RepLAB library.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-octave notranslate"><div class="highlight"><pre>
<span></span><span class="nb">run</span> <span class="p">.</span><span class="o">./</span><span class="p">.</span><span class="o">./</span><span class="p">.</span><span class="o">./</span><span class="n">replab_init</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Adding RepLAB to the path
warning: function /home/denis/w/replab/src/help.m shadows a core library function
Adding RepLAB package to the path
Loading optim package for Octave...
OpenJDK 64-Bit Server VM warning: Archived non-system classes are disabled because the java.system.class.loader property is specified (value = &#34;org.octave.OctClassLoader&#34;). To use archived non-system classes, this property must be not be set
Adding VPI to the path
Adding MOxUnit to the path
Adding embedded YALMIP to the path
Adding embedded SDPT3 solver to the path
Adding MOcov to the path
</pre></div></div>
</div>
<p>During the lecture, we found a form of the SDP that had only one optimization variable. We’ll now see how to symmetrize the problem completely.</p>
<p>We first declare the one and only variable, before constructing the moment matrix.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-octave notranslate"><div class="highlight"><pre>
<span></span><span class="n">y</span> <span class="p">=</span> <span class="n">sdpvar</span><span class="p">;</span> <span class="c">% y is actually y_A0B0, but we save space by identifying y with it</span>
<span class="n">X</span> <span class="p">=</span> <span class="p">[</span> <span class="mi">1</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
      <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">0</span>  <span class="n">y</span>  <span class="n">y</span>
      <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>  <span class="n">y</span> <span class="o">-</span><span class="n">y</span>
      <span class="mi">0</span>  <span class="n">y</span>  <span class="n">y</span>  <span class="mi">1</span>  <span class="mi">0</span>
      <span class="mi">0</span>  <span class="n">y</span> <span class="o">-</span><span class="n">y</span>  <span class="mi">0</span>  <span class="mi">1</span><span class="p">];</span>
<span class="n">I_CHSH</span> <span class="p">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">y</span><span class="p">;</span> <span class="c">% it is &lt;A0B0&gt; + &lt;A0B1&gt; + &lt;A1B0&gt; - &lt;A1B1&gt;, and y_A1B1 = -y_A0B0.</span>
<span class="n">optimize</span><span class="p">(</span><span class="n">X</span> <span class="o">&gt;</span><span class="p">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">I_CHSH</span><span class="p">,</span> <span class="n">sdpsettings</span><span class="p">(</span><span class="s">&#39;verbose&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span> <span class="c">% sign change to maximize, and we don&#39;t show solver out</span>
<span class="nb">double</span><span class="p">(</span><span class="n">I_CHSH</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
error: octave_base_value::map_value(): wrong type argument &#39;scalar&#39;
error: &#39;X&#39; undefined near line 1 column 10
ans = NaN
</pre></div></div>
</div>
<p>To help with symmetrization, we’ll use an equivalent form of the constraint X, and check the result.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-octave notranslate"><div class="highlight"><pre>
<span></span><span class="n">C</span> <span class="p">=</span> <span class="nb">eye</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span> <span class="c">% identity</span>
<span class="n">A</span> <span class="p">=</span> <span class="p">[</span><span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
     <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">1</span>
     <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span> <span class="o">-</span><span class="mi">1</span>
     <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">0</span>  <span class="mi">0</span>
     <span class="mi">0</span>  <span class="mi">1</span> <span class="o">-</span><span class="mi">1</span>  <span class="mi">0</span>  <span class="mi">0</span><span class="p">];</span>
<span class="n">X</span> <span class="p">=</span> <span class="n">C</span> <span class="o">+</span> <span class="n">A</span><span class="o">*</span><span class="n">y</span><span class="p">;</span> <span class="c">% equivalent to the constraint above</span>
<span class="n">optimize</span><span class="p">(</span><span class="n">X</span> <span class="o">&gt;</span><span class="p">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">I_CHSH</span><span class="p">);</span> <span class="c">% sign change to maximize</span>
<span class="nb">double</span><span class="p">(</span><span class="n">I_CHSH</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

 num. of constraints =  1
 dim. of sdp    var  =  5,   num. of sdp  blk  =  1
*******************************************************************
   SDPT3: Infeasible path-following algorithms
*******************************************************************
 version  predcorr  gam  expon  scale_data
   HKM      1      0.000   1        0
it pstep dstep pinfeas dinfeas  gap      prim-obj      dual-obj    cputime
-------------------------------------------------------------------
 0|0.000|0.000|8.0e-01|6.2e+00|5.0e+02| 5.000000e+01  0.000000e+00| 0:0:00| chol  1  1
 1|1.000|1.000|6.5e-08|6.9e-02|4.3e+01| 3.984640e+01  4.400004e-01| 0:0:00| chol  1  1
 2|0.933|1.000|1.5e-07|6.9e-03|2.9e+00| 3.700414e+00  8.665599e-01| 0:0:00| chol  1  1
 3|1.000|0.949|3.5e-08|1.0e-03|2.8e-01| 3.024905e+00  2.752468e+00| 0:0:00| chol  1  1
 4|0.987|0.988|1.1e-08|8.0e-05|3.4e-03| 2.830875e+00  2.827762e+00| 0:0:00| chol  1  1
 5|0.989|0.989|3.5e-10|7.7e-06|3.8e-05| 2.828454e+00  2.828448e+00| 0:0:00| chol  1  1
 6|0.989|0.989|8.9e-12|8.5e-08|4.2e-07| 2.828427e+00  2.828427e+00| 0:0:00|
  stop: max(relative gap, infeasibilities) &lt; 1.00e-07
-------------------------------------------------------------------
 number of iterations   =  6
 primal objective value =  2.82842742e+00
 dual   objective value =  2.82842735e+00
 gap := trace(XZ)       = 4.17e-07
 relative gap           = 6.26e-08
 actual relative gap    = 1.04e-08
 rel. primal infeas (scaled problem)   = 8.94e-12
 rel. dual     &#34;        &#34;       &#34;      = 8.49e-08
 rel. primal infeas (unscaled problem) = 0.00e+00
 rel. dual     &#34;        &#34;       &#34;      = 0.00e+00
 norm(X), norm(y), norm(Z) = 2.0e+00, 7.1e-01, 3.0e+00
 norm(A), norm(b), norm(C) = 3.8e+00, 5.0e+00, 3.2e+00
 Total CPU time (secs)  = 0.19
 CPU time per iteration = 0.03
 termination code       =  0
 DIMACS: 8.9e-12  0.0e+00  1.4e-07  0.0e+00  1.0e-08  6.3e-08
-------------------------------------------------------------------
ans =  2.8284
</pre></div></div>
</div>
<p>Now, we want to find a change of basis that brings X into a block-diagonal form. This is easier to check on the basis matrices <code class="docutils literal notranslate"><span class="pre">C</span></code> and <code class="docutils literal notranslate"><span class="pre">A</span></code>, i.e. we want to find <code class="docutils literal notranslate"><span class="pre">U</span></code> such that <code class="docutils literal notranslate"><span class="pre">U*C*U'</span></code> and <code class="docutils literal notranslate"><span class="pre">U*A*U'</span></code> are block-diagonal. Let us use RepLAB for that. First, remark that the moment matrix is invariant under the following signed permutations:</p>
<p>$:nbsphinx-math:<code class="xref mat mat-obj docutils literal notranslate"><span class="pre">vec{v}</span></code> = <span class="math">\left`( 1, A\_0, A\_1, B\_0, B\_1 :nbsphinx-math:</span>right`) <span class="math">\rightarrow  `:nbsphinx-math:</span>left`( 1, B_0, B_1, A_0, A_1 <span class="math">\right</span>) $</p>
<p>$:nbsphinx-math:<code class="xref mat mat-obj docutils literal notranslate"><span class="pre">vec{v}</span></code> = <span class="math">\left`( 1, A\_0, A\_1, B\_0, B\_1 :nbsphinx-math:</span>right`) <span class="math">\rightarrow  `:nbsphinx-math:</span>left`( 1, -A_0, -A_1, -B_0, -B_1 <span class="math">\right</span>) $</p>
<p>$:nbsphinx-math:<code class="xref mat mat-obj docutils literal notranslate"><span class="pre">vec{v}</span></code> = <span class="math">\left`( 1, A\_0, A\_1, B\_0, B\_1 :nbsphinx-math:</span>right`) <span class="math">\rightarrow  `:nbsphinx-math:</span>left`( 1, A_1, A_0, B_0, -B_1 <span class="math">\right</span>) $</p>
<p>We now show how to use RepLAB to find the change of basis for the symmetry group that includes only the first symmetry.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-octave notranslate"><div class="highlight"><pre>
<span></span><span class="n">g1</span> <span class="p">=</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">];</span> <span class="c">% permutation of parties</span>
<span class="n">g2</span> <span class="p">=</span> <span class="p">[</span><span class="mi">1</span> <span class="o">-</span><span class="mi">2</span> <span class="o">-</span><span class="mi">3</span> <span class="o">-</span><span class="mi">4</span> <span class="o">-</span><span class="mi">5</span><span class="p">];</span> <span class="c">% sign flip everywhere, note the signed permutation convention</span>
<span class="n">g3</span> <span class="p">=</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">3</span> <span class="mi">2</span> <span class="mi">4</span> <span class="o">-</span><span class="mi">5</span><span class="p">];</span> <span class="c">% additional symmetry</span>
</pre></div>
</div>
</div>
<p>We build the symmetry group from those generators, which are signed permutations on five elements. For the permutation of parties only, the order (=size) of the group is 2. When adding the other symmetries, the order of the group should be 16.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-octave notranslate"><div class="highlight"><pre>
<span></span><span class="n">nElements</span> <span class="p">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="n">G</span> <span class="p">=</span> <span class="n">replab</span><span class="p">.</span><span class="n">signed</span><span class="p">.</span><span class="n">Permutations</span><span class="p">(</span><span class="n">nElements</span><span class="p">).</span><span class="n">subgroup</span><span class="p">({</span><span class="n">g1</span> <span class="n">g2</span> <span class="n">g3</span><span class="p">});</span>
<span class="n">G</span><span class="p">.</span><span class="n">order</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ans =
    16
</pre></div></div>
</div>
<p>If necessary, we can also expand the group elements (use <code class="docutils literal notranslate"><span class="pre">G.elements.at(2)</span></code> to get the second element for example).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-octave notranslate"><div class="highlight"><pre>
<span></span><span class="n">G</span><span class="p">.</span><span class="n">elements</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ans =

Indexed family of 16 elements
 1 = [1, 2, 3, 4, 5]
 2 = [1, -3, -2, -4, 5]
 3 = [1, 2, -3, 5, 4]
 4 = [1, 3, -2, -5, 4]
 5 = [1, 4, 5, 2, 3]
 6 = [1, -5, -4, -2, 3]
 7 = [1, 4, -5, 3, 2]
 8 = [1, 5, -4, -3, 2]
 9 = [1, -4, 5, -3, -2]
10 = [1, -5, 4, 3, -2]
11 = [1, -4, -5, -2, -3]
12 = [1, 5, 4, 2, -3]
13 = [1, -2, 3, -5, -4]
14 = [1, -3, 2, 5, -4]
15 = [1, -2, -3, -4, -5]
16 = [1, 3, 2, 4, -5]

</pre></div></div>
</div>
<p>Now, the representation we need is composed of signed permutation matrices; as we are considering a group of signed permutations, this is the group <em>natural representation</em>. Representations in RepLAB are described using the images of the generators. By calling <code class="docutils literal notranslate"><span class="pre">G.sampleUniformly</span></code>, we get random elements from the group, and by calling <code class="docutils literal notranslate"><span class="pre">rep.image(g)</span></code> we get the image of a group element.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-octave notranslate"><div class="highlight"><pre>
<span></span><span class="n">rep</span> <span class="p">=</span> <span class="n">G</span><span class="p">.</span><span class="n">definingRep</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
rep =

Orthogonal real representation of dimension 5
    dimension: 5
        field: &#39;R&#39;
        group: replab.signed.PermutationSubgroup
inverseImages: 1 x 3 cell
    irrepInfo: []
    isUnitary: true
    images{1}: 5 x 5 double
    images{2}: 5 x 5 double
    images{3}: 5 x 5 double

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-octave notranslate"><div class="highlight"><pre>
<span></span><span class="n">g</span> <span class="p">=</span> <span class="n">G</span><span class="p">.</span><span class="n">sampleUniformly</span>
<span class="nb">full</span><span class="p">(</span><span class="n">rep</span><span class="p">.</span><span class="nb">image</span><span class="p">(</span><span class="n">g</span><span class="p">))</span> <span class="c">% we use full, as signed permutation representations return sparse matrices</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
g =

   1  -3  -2  -4   5

ans =

   1   0   0   0   0
   0   0  -1   0   0
   0  -1   0   0   0
   0   0   0  -1   0
   0   0   0   0   1

</pre></div></div>
</div>
<p>Now, we decompose the representation into irreducible components. For that, we call <code class="docutils literal notranslate"><span class="pre">rep.decomposition</span></code>. In the answer I(m)xR(d), we express that the component has <span class="math notranslate nohighlight">\(m\)</span> copies (multiplicity) of a <code class="docutils literal notranslate"><span class="pre">R</span></code>eal representation of dimension <code class="docutils literal notranslate"><span class="pre">d</span></code>. We then play with the indices of the component, and copy.</p>
<p>Hint: explore <code class="docutils literal notranslate"><span class="pre">rep.decomposition.component(i).irrep(j)</span></code> for <span class="math notranslate nohighlight">\((i,j) = (1,1), (2,1), (3,1)\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-octave notranslate"><div class="highlight"><pre>
<span></span><span class="n">rep</span><span class="p">.</span><span class="n">decomposition</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ans =

Subrepresentation
   dimension: 5
       field: &#39;R&#39;
       group: replab.signed.PermutationSubgroup
   irrepInfo: []
   isUnitary: true
   niceBasis: []
      parent: Orthogonal real representation of dimension 5
           U: 5 x 5 double
component(1): Isotypic component R(1)
component(2): Isotypic component R(2)
component(3): Isotypic component R(2)

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-octave notranslate"><div class="highlight"><pre>
<span></span><span class="n">rep</span><span class="p">.</span><span class="n">decomposition</span><span class="p">.</span><span class="n">component</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">irrep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ans =

Real irreducible subrepresentation of real type
dimension: 1
    field: &#39;R&#39;
    group: replab.signed.PermutationSubgroup
irrepInfo: replab.irreducible.TrivialInfo
isUnitary: true
niceBasis: replab.NiceBasis
   parent: Orthogonal real representation of dimension 5
   U(1,:): [1, 0, 0, 0, 0]

</pre></div></div>
</div>
<p>We now ask for the change of basis matrix, and verify that <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">C</span></code> block-diagonalize.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-octave notranslate"><div class="highlight"><pre>
<span></span><span class="n">U</span> <span class="p">=</span> <span class="nb">full</span><span class="p">(</span><span class="n">rep</span><span class="p">.</span><span class="n">decomposition</span><span class="p">.</span><span class="n">U</span><span class="p">)</span>
<span class="n">U</span><span class="o">*</span><span class="n">C</span><span class="o">*</span><span class="n">U</span><span class="o">&#39;</span>
<span class="n">U</span><span class="o">*</span><span class="n">A</span><span class="o">*</span><span class="n">U</span><span class="o">&#39;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
U =

   1.00000   0.00000   0.00000   0.00000   0.00000
   0.00000  -0.40628   0.57874  -0.12195   0.69651
   0.00000   0.57874   0.40628  -0.69651  -0.12195
   0.00000  -0.50000  -0.50000  -0.70711  -0.00000
   0.00000   0.50000  -0.50000  -0.00000   0.70711

ans =

   1.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   1.00000   0.00000  -0.00000   0.00000
   0.00000   0.00000   1.00000  -0.00000  -0.00000
   0.00000  -0.00000  -0.00000   1.00000   0.00000
   0.00000   0.00000  -0.00000   0.00000   1.00000

ans =

   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000  -1.41421   0.00000   0.00000  -0.00000
   0.00000   0.00000  -1.41421  -0.00000  -0.00000
   0.00000   0.00000  -0.00000   1.41421   0.00000
   0.00000  -0.00000   0.00000  -0.00000   1.41421

</pre></div></div>
</div>
<p>Once we have found the change of basis matrix, we transform our moment matrix <code class="docutils literal notranslate"><span class="pre">X</span></code>, and naturally it should have a block diagonal structure following the one of <code class="docutils literal notranslate"><span class="pre">C</span></code> and <code class="docutils literal notranslate"><span class="pre">A</span></code> – for that, it may be necessary to kill small off-block coefficients.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-octave notranslate"><div class="highlight"><pre>
<span></span><span class="n">X</span> <span class="p">=</span> <span class="p">(</span><span class="n">U</span><span class="o">*</span><span class="n">C</span><span class="o">*</span><span class="n">U</span><span class="o">&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">U</span><span class="o">*</span><span class="n">A</span><span class="o">*</span><span class="n">U</span><span class="o">&#39;</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="p">;</span> <span class="c">% equivalent to the constraint above</span>
<span class="n">optimize</span><span class="p">(</span><span class="n">X</span> <span class="o">&gt;</span><span class="p">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">I_CHSH</span><span class="p">);</span> <span class="c">% sign change to maximize</span>
<span class="nb">double</span><span class="p">(</span><span class="n">I_CHSH</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

 num. of constraints =  1
 dim. of sdp    var  =  5,   num. of sdp  blk  =  1  1th semidefinite block is actually diagonal

*******************************************************************
   SDPT3: Infeasible path-following algorithms
*******************************************************************
 version  predcorr  gam  expon  scale_data
   HKM      1      0.000   1        0
it pstep dstep pinfeas dinfeas  gap      prim-obj      dual-obj    cputime
-------------------------------------------------------------------
 0|0.000|0.000|8.0e-01|6.2e+00|5.0e+02| 5.000000e+01  0.000000e+00| 0:0:00| chol  1  1
 1|1.000|1.000|6.5e-08|6.9e-02|4.3e+01| 3.984640e+01  4.400004e-01| 0:0:00| chol  1  1
 2|0.933|1.000|1.5e-07|6.9e-03|2.9e+00| 3.700414e+00  8.665599e-01| 0:0:00| chol  1  1
 3|1.000|0.949|3.5e-08|1.0e-03|2.8e-01| 3.024905e+00  2.752468e+00| 0:0:00| chol  1  1
 4|0.987|0.988|1.1e-08|8.0e-05|3.4e-03| 2.830875e+00  2.827762e+00| 0:0:00| chol  1  1
 5|0.989|0.989|3.5e-10|7.7e-06|3.8e-05| 2.828454e+00  2.828448e+00| 0:0:00| chol  1  1
 6|0.989|0.989|8.9e-12|8.5e-08|4.2e-07| 2.828427e+00  2.828427e+00| 0:0:00|
  stop: max(relative gap, infeasibilities) &lt; 1.00e-07
-------------------------------------------------------------------
 number of iterations   =  6
 primal objective value =  2.82842742e+00
 dual   objective value =  2.82842735e+00
 gap := trace(XZ)       = 4.17e-07
 relative gap           = 6.26e-08
 actual relative gap    = 1.04e-08
 rel. primal infeas (scaled problem)   = 8.94e-12
 rel. dual     &#34;        &#34;       &#34;      = 8.49e-08
 rel. primal infeas (unscaled problem) = 0.00e+00
 rel. dual     &#34;        &#34;       &#34;      = 0.00e+00
 norm(X), norm(y), norm(Z) = 2.0e+00, 7.1e-01, 3.0e+00
 norm(A), norm(b), norm(C) = 3.8e+00, 5.0e+00, 3.2e+00
 Total CPU time (secs)  = 0.08
 CPU time per iteration = 0.01
 termination code       =  0
 DIMACS: 8.9e-12  0.0e+00  1.4e-07  0.0e+00  1.0e-08  6.3e-08
-------------------------------------------------------------------
ans =  2.8284
</pre></div></div>
</div>
<p>As an exercice, recover an algebraic basis from <code class="docutils literal notranslate"><span class="pre">U</span></code>, guess the form of the semidefinite program when fully block-diagonal (i.e. for the full group of CHSH symmetries). <strong>Remark that now the problem can be solved by hand to recover the</strong> <span class="math notranslate nohighlight">\(2\sqrt{2}\)</span> <strong>bound, as the SDP matrix is fully diagonal, and thus corresponds to linear inequalities.</strong></p>
</div>

  <div class="section">
  
  
  </div>

          </div>
            
  <div class="footer-relations">
    
      <div class="pull-left">
        <a class="btn btn-default" href="Tutorial1.html" title="previous chapter (use the left arrow)">1. Introduction to representation for quantum information people</a>
      </div>
    
      <div class="pull-right">
        <a class="btn btn-default" href="../../publications/index.html" title="next chapter (use the right arrow)">Publications using RepLAB</a>
      </div>
    </div>
    <div class="clearer"></div>
  
        </div>
        <div class="clearfix"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../mat-modindex.html" title="MATLAB Module Index"
             >matlab index</a> |</li>
        <li class="right" >
          <a href="../../publications/index.html" title="Publications using RepLAB"
             >next</a> |</li>
        <li class="right" >
          <a href="Tutorial1.html" title="1. Introduction to representation for quantum information people"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">RepLAB 0.6.6 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Talks</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >Brussels visit October 2019</a> &#187;</li> 
      </ul>
    </div>
<script type="text/javascript">
  $("#mobile-toggle a").click(function () {
    $("#left-column").toggle();
  });
</script>
<script type="text/javascript" src="../../_static/js/bootstrap.js"></script>
  <div class="footer">
    &copy; Copyright 2018-2020, Denis Rosset, Jean-Daniel Bancal and collaborators. Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div>
  </body>
</html>